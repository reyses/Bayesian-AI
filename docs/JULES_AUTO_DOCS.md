# Jules Auto-Documentation Task

**Schedule:** nightly at 03:00
**Goal:** Keep `docs/` in sync with the codebase and latest run results so Gemini always has accurate reference material when reviewing the repo.

---

## What Jules must do (in order)

### Step 1 — Find what changed since the last doc update

Run:
```
git log --oneline --since="2 days ago"
```
If nothing changed since the last doc run (no new commits), Jules may exit early with a `[AUTO-DOCS] No changes since last run` commit.

Also run:
```
git log --oneline -30
```
to get a broader picture of recent history.

---

### Step 2 — Update `docs/CHANGELOG.md`

Read the current `docs/CHANGELOG.md`.
Read the git log with full commit messages for any commits NOT already mentioned in the changelog:
```
git log --format="%H %s%n%b" --since="7 days ago"
```

For each new commit group that represents a logical feature/fix, prepend a new changelog entry at the top of the file (below the `# Changelog` header) in this format:

```markdown
## [Vx.x.x] - YYYY-MM-DD — <one-line summary>

### New
- <bullet describing new feature or file>

### Changed
- <bullet describing changed behaviour>

### Fixed
- <bullet describing bug fixed>

### Docs
- <bullet if any doc files were updated>
```

Rules:
- Use the actual commit messages and file names — do NOT hallucinate features
- Merge commits without meaningful bodies can be grouped or skipped
- Version number: increment minor if new feature, patch if fix, major if architectural overhaul
- If multiple commits belong to one logical change, merge them into one entry

---

### Step 3 — Update `docs/ARCHITECTURE.md`

Read these files in full to understand the current system:
- `core/quantum_field_engine.py` (top 80 lines + class signatures)
- `core/bayesian_brain.py` (top 60 lines + class signatures)
- `core/three_body_state.py` (full)
- `core/dynamic_binner.py` (full)
- `training/orchestrator.py` (lines 1-120 + argument parser section)
- `training/fractal_clustering.py` (top 80 lines + class signatures)
- `training/fractal_dna_tree.py` (top 60 lines)
- `training/timeframe_belief_network.py` (top 100 lines)
- `training/wave_rider.py` (top 80 lines + constants)
- `training/trade_analytics.py` (top 40 lines)
- `visualization/live_training_dashboard.py` (top 40 lines)

Then write/overwrite `docs/ARCHITECTURE.md` with this structure:

```markdown
# Bayesian-AI — Architecture Reference
> Auto-generated by Jules on YYYY-MM-DD. Do not edit manually.

## System Overview
<2-3 paragraph description of what the system does end-to-end>

## Phase Pipeline
| Phase | Name | File | Description |
|-------|------|------|-------------|
| 1 | Data Prep | ... | ... |
| 2 | Pattern Discovery | ... | ... |
| 3 | Template Optimization | ... | ... |
| 4 | Forward Pass | ... | ... |
| 5 | Strategy Selection | ... | ... |

## Core Files
| File | Class / Function | Role |
|------|-----------------|------|
| core/quantum_field_engine.py | QuantumFieldEngine | ... |
| core/bayesian_brain.py | BayesianBrain | ... |
| ... | ... | ... |

## Key Constants & Parameters
List the most important tunable constants found in the source files
(trail factors, gate thresholds, cluster settings, etc.) with their
current values and a one-line explanation of what they control.

## CLI Reference
List every `--flag` from the orchestrator argument parser with its
default value and description. Example:

| Flag | Default | Description |
|------|---------|-------------|
| --forward-pass | false | Run Phase 4 using existing playbook |
| --dashboard | false | Show full 1600x950 dashboard |
| --no-dashboard | false | Disable all UI |
| ... | ... | ... |

## Data Flow
<Mermaid diagram or ASCII art showing data flow from raw parquet →
 engine → brain → clustering → forward pass → oracle log → analytics>

## Output Files
| File | Location | Description |
|------|----------|-------------|
| oracle_trade_log.csv | checkpoints/ | Per-trade oracle log |
| phase4_report.txt | checkpoints/ | Forward pass report |
| trade_analytics.txt | checkpoints/ + run_logs/ | Statistical suite |
| pattern_library_long.pkl | checkpoints/ | LONG cluster templates |
| ... | ... | ... |
```

---

### Step 4 — Update `docs/SYSTEM_STATUS.md`

Check if any of these files exist in `run_logs/`:
- `trade_analytics.txt`
- Any `oracle_trade_log_*.csv` shards

Also check `checkpoints/phase4_report.txt`.

If found, read the relevant sections and write/overwrite `docs/SYSTEM_STATUS.md`:

```markdown
# Bayesian-AI — System Status
> Auto-generated by Jules on YYYY-MM-DD from the most recent forward pass.

## Latest Forward Pass Results
- **Date run:** <from report header>
- **Period simulated:** <start_date → end_date>
- **Net PnL:** $xx,xxx
- **Win Rate:** xx.x%
- **Total Trades:** x,xxx
- **Delta Capture Rate:** xx.x% (of sequential ideal)

## Exit Quality
- Trades with dynamic trail (tightened): x (avg $xx.xx)
- Trades with dynamic trail (widened): x (avg $xx.xx)
- Trades with standard trail: x (avg $xx.xx)

## Gate Summary
| Gate | Skipped | % of candidates |
|------|---------|-----------------|
| Gate 0 (noise) | x,xxx | xx% |
| Gate 1 (pattern match) | x,xxx | xx% |
| Gate 2 (belief) | x,xxx | xx% |
| Gate 3 (conviction) | x,xxx | xx% |
| Gate 3.5 (R:R) | x,xxx | xx% |
| Gate 4 (score) | x,xxx | xx% |

## Worker Agreement (from trade_analytics.txt if present)
<Copy the WORKER AGREEMENT AT ENTRY section from trade_analytics.txt>

## Top Depth Breakdown
<Copy the per-depth PnL table from phase4_report.txt>

## Known Issues / Next Actions
- <List any AVOID hours or depth filter_out recommendations from the analytics>
```

If no run data is found, write a placeholder: `No forward pass results available yet.`

---

### Step 5 — Commit the updated docs

Stage only the docs files:
```
git add docs/CHANGELOG.md docs/ARCHITECTURE.md docs/SYSTEM_STATUS.md
git commit -m "[AUTO-DOCS] Nightly documentation update YYYY-MM-DD

- CHANGELOG: added entries for recent commits
- ARCHITECTURE: refreshed from current source
- SYSTEM_STATUS: updated from latest run_logs/

Co-Authored-By: Jules <noreply@google.com>"
```

Then push:
```
git push origin main
```

---

## Rules for Jules

1. **Never modify source code** — read-only access to all `.py` files
2. **Never delete existing changelog entries** — only prepend new ones
3. **If a doc file does not exist**, create it from scratch
4. **If run_logs/ has no data**, write placeholder text — do not fail
5. **Version numbers** in CHANGELOG must be monotonically increasing — read the latest version from the file before incrementing
6. **Do not summarise what you're about to do** — just do it
7. **Keep ARCHITECTURE.md under 400 lines** — be concise, use tables
8. **Keep SYSTEM_STATUS.md under 200 lines** — metrics only, no prose padding
